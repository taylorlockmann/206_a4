---
title: "a4_task2_taylor_lockmann"
author: "Taylor Lockmann"
date: "11/17/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
library(tidyverse)
library(here)
library(lubridate)
library(kableExtra)
library(beeswarm)
```

```{r}
## Read in the data
bonanza_hares <- read.csv(here("data", "bonanza_hares.csv"))
```

#### Introduction


#### Data and Analyses


#### Exploratory findings

##### i. Annual juvenile hare trap counts

```{r}
juvenile_hares <- bonanza_hares %>% # Start with our full dataset
  filter(age == "j") %>% # Filter to include only juveniles
  mutate(date_new = mdy(date)) %>%   # Change "date" column to "Date" class
  mutate(year_new = year(date_new))  # Create a new column of only the year

juv_hare_per_yr <- juvenile_hares %>% 
  group_by(year_new) %>% 
  count(year_new) %>% 
  rename(number = n)

ggplot(data = juv_hare_per_yr, aes(x = year_new))+ # Create a ggplot using the data we rearranged, with "year" as our x-axis
  geom_col(aes(y = number), fill = "darkgreen")+
  theme_minimal()+
  labs(
    x = "Year",
    y = "Count",
    title = "Number of Juvenile Hares Trapped Each Year",
    caption = "Figure 1: Number of juvenile hares caught across all grid sites during each year"
  )
```


From the above figure, we can see that the highest number of hares trapped in a single year was 126 hares during 1999. The lowest number trapped in a single year was 0 in 2002 and 2009. Based on the imagery of the graph, we can see there is a slight jump in the number of juveniles caught every three years between 2003-2011. To standardize the juvenile hare population in future analyses, we could specify how many traps are placed at each site and how many days those traps were used, then use observations as a percentage of total observations at each site to obtain a more standardized analysis. Or we could take a random sampling of a specified number of traps at each site for each year (for example, 3 randomized individual observations from each site each year). 


##### ii. Juvenile hare weights

```{r}
grid.labs <- c("Bonanza Black Spruce", "Bonanza Mature", "Bonanza Riparian")
names(grid.labs) <- c("bonbs", "bonmat", "bonrip") #Set up the names I want each of the facets to be called - make sure they match up in the vectors.

ggplot()+
  geom_boxplot(data = juvenile_hares, aes(x = sex, y = weight, fill = sex))+
  facet_wrap(~grid, labeller = labeller(grid=grid.labs))+
  labs(
    x = "Sex",
    y = "Weight (g)",
    caption = "Figure 2: Juvenile hare weights across bonanza creek sites",
    title = "Juvenile hare weight statistics by sex, 1998-2012"
  )
```

From Figure 2 we can see that the median weights for both male and female hares in the "Bonanza Mature" and "Bonanza Riparian" sites are similar, and are slightly lower than those of the "Bonanza Black Spruce" groups. However, we can also see that several groups across each of our sites have a large spread in their weights, with two groups having outliers (m Bonanza Black Spruce and f Bonanza Riparian). Overall, males in the Bonanza Black Spruce site have the highest median weight of any group, but males in Bonanza Riparian have the highest weight overall.  

##### iii. Juvenile weight comparison (male & female snowshoe hares)

```{r}
m_f_juv_hares <- juvenile_hares %>% 
  filter(sex == "m" | sex == "f")

juv_weight_stats <- m_f_juv_hares %>% 
  filter(weight != "NA") %>% 
  group_by(sex) %>% 
  summarize(mean_weight_g = mean(weight),
            median_weight_g = median(weight),
            sd_weight_g = sd(weight),
            sample_size = n())

kbl(juv_weight_stats, caption = "Summary statistics of weight for male and female juvenile hares") %>% 
  kable_styling(bootstrap_options = "striped",
                full_width = F)
```

From our statistics summary table, we can see that the actual difference between means is approximately 90.5g. 

##### iv. Relationship between juvenile weight & hind foot length

#### Summary


#### Citations